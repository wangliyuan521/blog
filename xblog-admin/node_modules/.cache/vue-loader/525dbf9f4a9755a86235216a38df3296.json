{"remainingRequest":"D:\\xblog\\xblog-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\xblog\\xblog-admin\\src\\views\\user\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\xblog\\xblog-admin\\src\\views\\user\\index.vue","mtime":1583764183112},{"path":"D:\\xblog\\xblog-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xblog\\xblog-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\xblog\\xblog-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\xblog\\xblog-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { fetchUserList, updateUser, deleteUser } from '@/api/user'\nimport Pagination from '@/components/Pagination'\nimport Upload from '@/components/Upload'\nexport default {\n  name: 'ComplexTable',\n  components: {\n    lbUpload: Upload, Pagination\n  },\n  data() {\n    return {\n      tableKey: 0,\n      list: null,\n      total: 0,\n      listLoading: true,\n      listQuery: {\n        page: 1,\n        limit: 20\n      },\n      user: {\n        id: undefined,\n        username: '',\n        password: '',\n        role: '',\n        phone: '',\n        email: '',\n        sex: '',\n        avatar: '',\n        preInfo: '',\n        status: 0\n      },\n      dialogFormVisible: false,\n      dialogStatus: '',\n      textMap: {\n        update: '更新',\n        create: '添加'\n      },\n      rules: {\n        username: [{ required: true, message: '账号必填项', trigger: 'change' }],\n        password: [{ required: true, message: '密码必填项', trigger: 'change' }],\n        role: [{ required: true, message: '角色必填项', trigger: 'change' }]\n      }\n    }\n  },\n  created() {\n    this.refreshTable()\n  },\n  methods: {\n    refreshTable() {\n      fetchUserList(this.listQuery).then(response => {\n        this.list = response.data.list\n        this.total = response.data.total\n      })\n    },\n    handleModifyStatus(row, status) {\n      row.status = status\n      row.updateTime = null\n      updateUser(row).then(response => {\n        // 刷新表格\n        this.refreshTable()\n        if (status === 1) {\n          this.$message({\n            message: '禁用成功',\n            type: 'success',\n            duration: 2000\n          })\n        } else {\n          this.$message({\n            message: '启用成功',\n            type: 'success',\n            duration: 2000\n          })\n        }\n      })\n    },\n    handleUpdate(row) {\n      this.user = Object.assign({}, row) // copy obj\n      this.dialogStatus = 'update'\n      this.dialogFormVisible = true\n      this.$nextTick(() => {\n        this.$refs['dataForm'].clearValidate()\n      })\n    },\n    updateData() {\n      this.$refs['dataForm'].validate((valid) => {\n        if (valid) {\n          const formData = Object.assign({}, this.user)\n          updateUser(formData).then(() => {\n            this.dialogFormVisible = false\n            this.refreshTable()\n            this.$notify({\n              title: 'Success',\n              message: '更新成功',\n              type: 'success',\n              duration: 2000\n            })\n          })\n        }\n      })\n    },\n    // 删除操作\n    handleDelete(row, index) {\n      this.$confirm(`此操作将永久删除该用户, 是否继续?`, '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        deleteUser(row.id).then(response => {\n          // 刷新表格\n          this.refreshTable()\n          this.$message({\n            title: 'Success',\n            message: '删除成功!',\n            type: 'success',\n            duration: 2000\n          })\n        })\n      })\n    }\n  }\n}\n",null]}